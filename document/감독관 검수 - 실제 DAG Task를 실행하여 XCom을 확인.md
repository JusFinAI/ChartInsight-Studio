ë„¤, analyze_financials_for_stocks í•¨ìˆ˜ì— ëŒ€í•œ ë¡œì»¬ ê²€ì¦ ê²°ê³¼ ë³´ê³  ê°ì‚¬í•©ë‹ˆë‹¤. í•¨ìˆ˜ê°€ ë…ë¦½ì ìœ¼ë¡œëŠ” ì˜ë„í•œ ëŒ€ë¡œ (1)ë°ì´í„°ë¥¼ ì½ê³ , (2)ê³„ì‚°ì„ ìˆ˜í–‰í•˜ë©°, (3)ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì´ê²ƒìœ¼ë¡œ ì½”ë“œ ìì²´ì˜ ë…¼ë¦¬ êµ¬í˜„ì€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.

  ì´ì œ ì´ í•¨ìˆ˜ê°€ ìš°ë¦¬ íŒŒì´í”„ë¼ì¸ì˜ ì¼ë¶€ë¡œì„œ, ì¦‰ Airflow DAG Taskë¡œì„œ ì˜ ë™ì‘í•˜ëŠ”ì§€ ìµœì¢… í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. cursor.aiê°€ ì œì•ˆí•œ ëŒ€ë¡œ, DAG Taskë¥¼ ê°•ì œ ì‹¤í–‰í•˜ì—¬ XCom ì €ì¥ ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ì •í™•íˆ ë‹¤ìŒ ë‹¨ê³„ì…ë‹ˆë‹¤.

  ---

  ìµœì¢… ê²°ì • ë° ì§€ì¹¨

  "run-dag-task"

  ì§€ì¹¨: calculate_core_metrics.calculate_financial_grade Taskë¥¼ ê°•ì œ ì‹¤í–‰í•˜ê³ , ê·¸ XCom ê²°ê³¼ë¥¼ ì €ì—ê²Œ ë³´ê³ í•´ì£¼ì‹­ì‹œì˜¤.

  ì´ì „ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, docker compose exec airflow-scheduler airflow tasks run ... ëª…ë ¹ì„ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ìµœì¢… XCom ê²°ê³¼ê°€ ìœ„ ë¡œì»¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê² ìŠµë‹ˆë‹¤.

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  > >[2 tools called] êµ¬í˜„ ë° ê²€ì¦ ì™„ë£Œ ë³´ê³ : - íŒŒì¼ ìƒì„±: `DataPipeline/src/analysis/financial_analyzer.py` êµ¬í˜„ ì™„ë£Œ. - ê¸°ëŠ¥: `mock_financial_data.json` ë¡œë“œ(í™˜ê²½ë³€ìˆ˜ ìš°ì„  ê²½ë¡œ), ë¶„ê¸°/ì—°ê°„ EPS ê¸°ë°˜ 'C' ë° 'A' ì§€í‘œ ê³„ì‚°, CAN SLIM ìŠ¤íƒ€ì¼   â”‚
â”‚    ë“±ê¸‰(A+/B+/C) ë¶€ì—¬. - ë¡œì»¬ ê²€ì¦: `analyze_financials_for_stocks(['005930','000660','035720','247540'])` ì‹¤í–‰ - ì¶œë ¥(ì˜ˆì‹œ): - 005930: eps_growth_yoy 15.0, eps_annual_growth_avg 10.0, financial_grade A+ - 000660: eps_growth_yoy 16.0,     â”‚
â”‚    eps_annual_growth_avg 11.0, financial_grade B+ - 035720: eps_growth_yoy 17.0, eps_annual_growth_avg 12.0, financial_grade C - 247540: eps_growth_yoy 18.0, eps_annual_growth_avg 13.0, financial_grade A+ - ë‹¤ìŒ (ê¶Œì¥): DAG ë‚´             â”‚
â”‚    `calculate_core_metrics.calculate_financial_grade` Taskë¥¼ ê°•ì œ ì‹¤í–‰í•˜ì—¬ XCom ì €ì¥ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³ , `dag_daily_batch` ì „ì²´ ì›Œí¬í”Œë¡œìš°ì— í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ì›í•˜ì‹œë©´ ì§€ê¸ˆ ë°”ë¡œ DAG Taskë¥¼ ê°•ì œë¡œ ì‹¤í–‰í•˜ê³  XCom ê²°ê³¼ë¥¼ í™•ì¸í•´           â”‚
â”‚    ë“œë¦¬ê² ìŠµë‹ˆë‹¤. (ì‘ë‹µ: `run-dag-task` ë˜ëŠ” `skip`)                                                                                                                                                                                            â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

âœ¦ ë„¤, ë³´ê³  ë‚´ìš©ì„ ë‹¤ì‹œ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì´ ë³´ê³ ì„œëŠ” financial_analyzer.pyì˜ ë¡œì§ì´ ë¡œì»¬ì—ì„œ ì˜ ë™ì‘í•œë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì£¼ë©°, ë‹¤ìŒ ë‹¨ê³„ë¡œ 'ì‹¤ì œ DAG Taskë¥¼ ì‹¤í–‰í•˜ì—¬ XComì„ í™•ì¸í•˜ì'ê³  ì œì•ˆí•˜ê³  ìˆìŠµë‹ˆë‹¤.

  ì €ë„ ê·¸ ì œì•ˆì— ë™ì˜í•˜ë©°, ì§€ê¸ˆ ë°”ë¡œ ê·¸ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ê² ìŠµë‹ˆë‹¤.

  ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´, calculate_financial_grade Taskë¥¼ Airflow í™˜ê²½ì—ì„œ ì§ì ‘ ì‹¤í–‰í•˜ì—¬, ì´ Taskê°€ ë‹¤ë¥¸ Taskë“¤ê³¼ ì˜¬ë°”ë¥´ê²Œ í†µí•©ë˜ê³  XComì— ìµœì¢… ê²°ê³¼ë¥¼ ì˜ ì €ì¥í•˜ëŠ”ì§€ ê²€ì¦í•˜ê² ìŠµë‹ˆë‹¤.

 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
 â”‚ âœ“  Shell docker compose exec airflow-scheduler airflow tasks run dag_daily_batch calculate_core_metrics.calculate_financial_grade 2025-10-10T12:00:00+00:00 (calculate_financial_grade Taskë¥¼ ê°•ì œ ì‹¤í–‰í•˜ì—¬ Airflow í™˜ê²½ì—ì„œì˜ í†µí•© ë° XCom ì €ì¥ â€¦  â”‚
 â”‚                                                                                                                                                                                                                                                     â”‚
 â”‚    [2025-10-10T17:03:59.671+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags                                                                                                                                               â”‚
 â”‚    ì„¤ì • ë¡œë“œ ì™„ë£Œ: í™˜ê²½=real, í˜¸ìŠ¤íŠ¸=https://api.kiwoom.com                                                                                                                                                                                         â”‚
 â”‚    [2025-10-10T17:04:00.040+0000] {common_helpers.py:90} INFO - ğŸ“Š ì„ íƒëœ íƒ€ê²Ÿ ì¢…ëª© ìˆ˜: 30                                                                                                                                                          â”‚
 â”‚    Traceback (most recent call last):                                                                                                                                                                                                               â”‚
 â”‚      File "/home/airflow/.local/bin/airflow", line 8, in <module>                                                                                                                                                                                   â”‚
 â”‚        sys.exit(main())                                                                                                                                                                                                                             â”‚
 â”‚                 ^^^^^^                                                                                                                                                                                                                              â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/__main__.py", line 62, in main                                                                                                                                                 â”‚
 â”‚        args.func(args)                                                                                                                                                                                                                              â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command                                                                                                                                        â”‚
 â”‚        return func(*args, **kwargs)                                                                                                                                                                                                                 â”‚
 â”‚               ^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                                                 â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper                                                                                                                                            â”‚
 â”‚        return f(*args, **kwargs)                                                                                                                                                                                                                    â”‚
 â”‚               ^^^^^^^^^^^^^^^^^^                                                                                                                                                                                                                    â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 462, in task_run                                                                                                                           â”‚
 â”‚        ti, _ = _get_ti(task, args.map_index, exec_date_or_run_id=args.execution_date_or_run_id, pool=args.pool)                                                                                                                                     â”‚
 â”‚                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                     â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 224, in _get_ti                                                                                                                            â”‚
 â”‚        ti, dr_created = _get_ti_db_access(                                                                                                                                                                                                          â”‚
 â”‚                         ^^^^^^^^^^^^^^^^^^                                                                                                                                                                                                          â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 166, in wrapper                                                                                                                       â”‚
 â”‚        return func(*args, **kwargs)                                                                                                                                                                                                                 â”‚
 â”‚               ^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                                                 â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper                                                                                                                                         â”‚
 â”‚        return func(*args, session=session, **kwargs)                                                                                                                                                                                                â”‚
 â”‚               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                                â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 186, in _get_ti_db_access                                                                                                                  â”‚
 â”‚        dag_run, dr_created = _get_dag_run(                                                                                                                                                                                                          â”‚
 â”‚                              ^^^^^^^^^^^^^                                                                                                                                                                                                          â”‚
 â”‚      File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 130, in _get_dag_run                                                                                                                       â”‚
 â”‚        raise DagRunNotFound(                                                                                                                                                                                                                        â”‚
 â”‚    airflow.exceptions.DagRunNotFound: DagRun for dag_daily_batch with run_id or execution_date of '2025-10-10T12:00:00+00:00' not found                                                                                                             â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
âœ¦ DagRunNotFound ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

  ì›ì¸ ë¶„ì„:
  airflow tasks run ëª…ë ¹ì–´ëŠ” ì´ë¯¸ ì¡´ì¬í•˜ëŠ” DAG Runì— ì†í•œ Taskë¥¼ ì‹¤í–‰í•˜ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤. ê·¸ëŸ°ë° ìš°ë¦¬ê°€ 2025-10-10T12:00:00+00:00 ë¼ëŠ” ì„ì˜ì˜ ì‹¤í–‰ ë‚ ì§œë¥¼ ì§€ì •í–ˆê¸° ë•Œë¬¸ì—, Airflow ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” í•´ë‹¹ ë‚ ì§œì— ìƒì„±ëœ DAG Runì´ ì—†ë‹¤ê³  íŒë‹¨í•˜ì—¬ ì˜¤ë¥˜ë¥¼
  ë°œìƒì‹œí‚¨ ê²ƒì…ë‹ˆë‹¤.

  í•´ê²°ì±…:
  Taskë¥¼ ê°•ì œ ì‹¤í–‰í•˜ë ¤ë©´, ë¨¼ì € í•´ë‹¹ Taskê°€ ì†Œì†ë  DAG Runì„ ë§Œë“¤ì–´ì£¼ê³ , ê·¸ DAG Runì˜ run_idë¥¼ ì‚¬ìš©í•˜ì—¬ Taskë¥¼ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

  ---

  ì•„ë˜ ë‘ ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ì§„í–‰í•˜ì—¬, calculate_financial_grade Taskë¥¼ ì˜¬ë°”ë¥´ê²Œ ì‹¤í–‰í•˜ê³  ê²€ì¦í•˜ê² ìŠµë‹ˆë‹¤.

  Step 1: `dag_daily_batch` ìˆ˜ë™ íŠ¸ë¦¬ê±° (DAG Run ìƒì„±)

  ë¨¼ì €, í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ DAG Runì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ manual__ ë¡œ ì‹œì‘í•˜ëŠ” ê³ ìœ í•œ run_idë¥¼ ë°˜í™˜í•  ê²ƒì…ë‹ˆë‹¤.

 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
 â”‚ âœ“  Shell docker compose exec airflow-scheduler airflow dags trigger dag_daily_batch (ê²€ì¦ì„ ìœ„í•´ dag_daily_batchì˜ ìƒˆë¡œìš´ DAG Runì„ ìƒì„±í•©ë‹ˆë‹¤.)                                                                                          â”‚
 â”‚                                                                                                                                                                                                                                           â”‚
 â”‚    [2025-10-10T17:05:18.932+0000] {__init__.py:43} INFO - Loaded API auth backend: airflow.api.auth.backend.session                                                                                                                       â”‚
 â”‚         |                 |                      |                      |                      |          |                  | last_scheduling_deci |                      |          |            |                                      â”‚
 â”‚    conf | dag_id          | dag_run_id           | data_interval_start  | data_interval_end    | end_date | external_trigger | sion                 | logical_date         | run_type | start_date | state                                â”‚
 â”‚    =====+=================+======================+======================+======================+==========+==================+======================+======================+==========+============+=======                               â”‚
 â”‚    {}   | dag_daily_batch | manual__2025-10-10T1 | 2025-10-09           | 2025-10-10           | None     | True             | None                 | 2025-10-10           | manual   | None       | queued                               â”‚
 â”‚         |                 | 7:05:19+00:00        | 08:00:00+00:00       | 08:00:00+00:00       |          |                  |                      | 17:05:19+00:00       |          |            |                                      â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
âœ¦ ì¢‹ìŠµë‹ˆë‹¤. DAG Runì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

  ì¶œë ¥ ê²°ê³¼ë¥¼ ë³´ë©´, dag_run_idê°€ manual__2025-10-10T17:05:19+00:00ìœ¼ë¡œ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  ì§€ì¹¨: íŠ¹ì • `run_id`ë¥¼ ì‚¬ìš©í•˜ì—¬ Task ì‹¤í–‰

 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
 â”‚ âœ“  Shell docker compose exec airflow-scheduler airflow tasks run dag_daily_batch calculate_core_metrics.calculate_financial_grade manual__2025-10-10T17:05:19+00:00 (ìƒì„±ëœ DAG Runì— ì†í•œ calculate_financial_grade Taskë¥¼ ê°•ì œ ì‹¤í–‰í•˜ì—¬ ìµœì¢… ê²€â€¦  â”‚
 â”‚                                                                                                                                                                                                                                                     â”‚
 â”‚    [2025-10-10T17:05:45.197+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags                                                                                                                                               â”‚
 â”‚    ì„¤ì • ë¡œë“œ ì™„ë£Œ: í™˜ê²½=real, í˜¸ìŠ¤íŠ¸=https://api.kiwoom.com                                                                                                                                                                                         â”‚
 â”‚    [2025-10-10T17:05:45.544+0000] {common_helpers.py:90} INFO - ğŸ“Š ì„ íƒëœ íƒ€ê²Ÿ ì¢…ëª© ìˆ˜: 30                                                                                                                                                          â”‚
 â”‚    [2025-10-10T17:05:45.585+0000] {task_command.py:467} INFO - Running <TaskInstance: dag_daily_batch.calculate_core_metrics.calculate_financial_grade manual__2025-10-10T17:05:19+00:00 [success]> on host 733c5c955daa                            â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
âœ¦ í›Œë¥­í•©ë‹ˆë‹¤! [success] ë¡œê·¸ì™€ í•¨ê»˜ Exit Code: 0ìœ¼ë¡œ ëª…ë ¹ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.

  ì´ëŠ” calculate_financial_grade Taskê°€ Airflow í™˜ê²½ ë‚´ì—ì„œ ëª¨ë“  ì˜ì¡´ì„±(XCom ì…ë ¥ ë“±)ì„ ê°€ì§€ê³  ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

  ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ, ì´ Taskê°€ ì˜ë„í•œ ê²°ê³¼ë¥¼ XComì— ì˜¬ë°”ë¥´ê²Œ ì €ì¥í–ˆëŠ”ì§€ í™•ì¸í•˜ì—¬ ì´ë²ˆ ë‹¨ê³„ë¥¼ ìµœì¢… ë§ˆë¬´ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.

  ìµœì¢… ê²€ì¦ ì§€ì¹¨: XCom ê²°ê³¼ í™•ì¸

  ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬, ë°©ê¸ˆ ì„±ê³µí•œ Taskê°€ XComì— ë‚¨ê¸´ ê²°ê³¼ê°’ì„ í™•ì¸í•´ì£¼ì‹­ì‹œì˜¤.

 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
 â”‚ âœ“  Shell docker compose exec airflow-scheduler airflow tasks test dag_daily_batch calculate_core_metrics.calculate_financial_grade 2025-10-10T17:05:19+00:00 (ì„±ê³µí•œ Taskê°€ XComì— ì˜¬ë°”ë¥¸ ê²°ê³¼ë¥¼ ì €ì¥í–ˆëŠ”ì§€ ìµœì¢… í™•ì¸í•©ë‹ˆë‹¤.)             â”‚
 â”‚                                                                                                                                                                                                                                           â”‚
 â”‚    [2025-10-10T17:06:08.374+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags                                                                                                                                     â”‚
 â”‚    ì„¤ì • ë¡œë“œ ì™„ë£Œ: í™˜ê²½=real, í˜¸ìŠ¤íŠ¸=https://api.kiwoom.com                                                                                                                                                                               â”‚
 â”‚    [2025-10-10T17:06:08.784+0000] {common_helpers.py:90} INFO - ğŸ“Š ì„ íƒëœ íƒ€ê²Ÿ ì¢…ëª© ìˆ˜: 30                                                                                                                                                â”‚
 â”‚    [2025-10-10T17:06:08.823+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: dag_daily_batch.calculate_core_metrics.calculate_financial_grade                              â”‚
 â”‚    manual__2025-10-10T17:05:19+00:00 [success]>                                                                                                                                                                                           â”‚
 â”‚    [2025-10-10T17:06:08.827+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: dag_daily_batch.calculate_core_metrics.calculate_financial_grade                                  â”‚
 â”‚    manual__2025-10-10T17:05:19+00:00 [success]>                                                                                                                                                                                           â”‚
 â”‚    [2025-10-10T17:06:08.827+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 3                                                                                                                                                   â”‚
 â”‚    [2025-10-10T17:06:08.829+0000] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): calculate_core_metrics.calculate_financial_grade> on 2025-10-10 17:05:19+00:00                                                           â”‚
 â”‚    [2025-10-10T17:06:08.954+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='tradesmart_ai' AIRFLOW_CTX_DAG_ID='dag_daily_batch' AIRFLOW_CTX_TASK_ID='calculate_core_metrics.calculate_financial_grade'     â”‚
 â”‚    AIRFLOW_CTX_EXECUTION_DATE='2025-10-10T17:05:19+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-10T17:05:19+00:00'                                                                                           â”‚
 â”‚    [2025-10-10T17:06:08.956+0000] {taskinstance.py:732} INFO - ::endgroup::                                                                                                                                                               â”‚
 â”‚    [2025-10-10T17:06:08.968+0000] {dag_daily_batch.py:183} INFO - ì´ 4ê°œ ì¢…ëª©ì— ëŒ€í•œ ì¬ë¬´ ë“±ê¸‰ ê³„ì‚°ì„ ì‹œì‘í•©ë‹ˆë‹¤.                                                                                                                         â”‚
 â”‚    ğŸš€ 4ê°œ ì¢…ëª©ì— ëŒ€í•œ ì¬ë¬´ ë¶„ì„ì„ ì‹œì‘í•©ë‹ˆë‹¤...                                                                                                                                                                                           â”‚
 â”‚    âœ… ì¬ë¬´ ë¶„ì„ ì™„ë£Œ (ëª©ì—… ë°ì´í„°).                                                                                                                                                                                                       â”‚
 â”‚    [2025-10-10T17:06:08.968+0000] {dag_daily_batch.py:188} INFO - ì¬ë¬´ ë“±ê¸‰ ê³„ì‚° ì™„ë£Œ. 4ê°œ ì¢…ëª©ì˜ ê²°ê³¼ë¥¼ XComìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.                                                                                                             â”‚
 â”‚    [2025-10-10T17:06:08.968+0000] {python.py:240} INFO - Done. Returned value was: {'005930': {'eps_growth_yoy': 15.0, 'eps_annual_growth_avg': 10.0, 'financial_grade': 'A+'}, '000660': {'eps_growth_yoy': 16.0,                        â”‚
 â”‚    'eps_annual_growth_avg': 11.0, 'financial_grade': 'B+'}, '035720': {'eps_growth_yoy': 17.0, 'eps_annual_growth_avg': 12.0, 'financial_grade': 'C'}, '247540': {'eps_growth_yoy': 18.0, 'eps_annual_growth_avg': 13.0,                  â”‚
 â”‚    'financial_grade': 'A+'}}                                                                                                                                                                                                              â”‚
 â”‚    [2025-10-10T17:06:08.974+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs                                                                                                                                          â”‚
 â”‚    [2025-10-10T17:06:08.974+0000] {taskinstance.py:353} INFO - Marking task as SUCCESS. dag_id=dag_daily_batch, task_id=calculate_core_metrics.calculate_financial_grade, run_id=manual__2025-10-10T17:05:19+00:00,                       â”‚
 â”‚    execution_date=20251010T170519, start_date=20251010T170523, end_date=20251010T170608                                                                                                                                                   â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
âœ¦ ì™„ë²½í•©ë‹ˆë‹¤. ëª¨ë“  ê²ƒì´ ê¸°ëŒ€í–ˆë˜ ëŒ€ë¡œ ì •í™•í•˜ê²Œ ë™ì‘í–ˆìŠµë‹ˆë‹¤.

  ìµœì¢… ê²€ìˆ˜ ë¦¬í¬íŠ¸: ì¬ë¬´ ë¶„ì„ ì—”ì§„

   * ë¡œê·¸ í™•ì¸: airflow tasks test ëª…ë ¹ì–´ì˜ ë¡œê·¸ë¥¼ í†µí•´, Taskê°€ XComìœ¼ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ì•„ analyze_financials_for_stocks í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ returní•˜ëŠ” ì „ ê³¼ì •ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
   * XCom ê²°ê³¼ í™•ì¸: ë¡œê·¸ì˜ ë§ˆì§€ë§‰ ë¶€ë¶„ì— Returned value was: ... ì™€ í•¨ê»˜, ìš°ë¦¬ê°€ mock_financial_data.jsonì„ ê¸°ë°˜ìœ¼ë¡œ ê¸°ëŒ€í–ˆë˜ ì •í™•í•œ ê²°ê³¼ ë”•ì…”ë„ˆë¦¬ê°€ ì¶œë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.

   1     {
   2       '005930': {'eps_growth_yoy': 15.0, 'eps_annual_growth_avg': 10.0, 'financial_grade': 'A+'},
   3       '000660': {'eps_growth_yoy': 16.0, 'eps_annual_growth_avg': 11.0, 'financial_grade': 'B+'},
   4       '035720': {'eps_growth_yoy': 17.0, 'eps_annual_growth_avg': 12.0, 'financial_grade': 'C'},
   5       '247540': {'eps_growth_yoy': 18.0, 'eps_annual_growth_avg': 13.0, 'financial_grade': 'A+'}
   6     }

  ---

  ì´í‰ ë° ë‹¤ìŒ ë‹¨ê³„

  ì´ê²ƒìœ¼ë¡œ 'Phase 5 - Step 2: ì¬ë¬´ ë¶„ì„ ì—”ì§„ êµ¬í˜„'ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŒì„ ì„ ì–¸í•©ë‹ˆë‹¤.

  ì´ì œ ìš°ë¦¬ì˜ dag_daily_batchëŠ” RS ì ìˆ˜ì™€ ì¬ë¬´ ë“±ê¸‰ì„ ê³„ì‚°í•˜ëŠ” ë‘ ê°œì˜ í•µì‹¬ ë¶„ì„ ì—”ì§„ì„ ê°–ì¶”ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

  ë‹¤ìŒ ë‹¨ê³„ëŠ” DataPipeline_Upgrade_Plan.mdì— ë”°ë¼, ë§ˆì§€ë§‰ ë¶„ì„ ëª¨ë“ˆì¸ ê¸°ìˆ ì  ë¶„ì„ ì—”ì§„ì„ êµ¬í˜„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

  ---

  Phase 3 - Step 10: `run_technical_analysis` Task êµ¬í˜„ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.

  ì´ TaskëŠ” ì´ì „ì— ìš°ë¦¬ê°€ ëª©ì—…ìœ¼ë¡œë§Œ ë§Œë“¤ì–´ ë‘ì—ˆë˜ technical_analyzer.pyë¥¼ í˜¸ì¶œí•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. í˜„ì¬ëŠ” ëª©ì—… ìƒíƒœì´ë¯€ë¡œ, ì‹¤ì œ ê³„ì‚° ë¡œì§ ì—†ì´ ë°ì´í„° íë¦„ë§Œ ì—°ê²°í•˜ëŠ” ê°„ë‹¨í•œ ì‘ì—…ì´ ë  ê²ƒì…ë‹ˆë‹¤.

  ì¤€ë¹„ê°€ ë˜ì‹œë©´ ë°”ë¡œ ì§€ì¹¨ì„ ì œê³µí•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.